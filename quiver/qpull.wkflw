{"actions":[{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport json, os\nimport editor, console, workflow\nimport quiverlib\n\nlocal = '\/var\/mobile\/Containers\/Data\/Application\/CC178706-BBCC-4E01-87EE-71BC9E9768C3\/Documents'\ndbox = '\/var\/mobile\/Containers\/Data\/Application\/CC178706-BBCC-4E01-87EE-71BC9E9768C3\/Library\/Application Support\/Dropbox'\n\ntry:\n\troot, notedir = editor.get_selected_folder()\n\tnotebook, _ = os.path.split(notedir)\n\tnb = json.loads(editor.get_file_contents(os.path.join(notebook, 'meta.json'), root))\n\tnote = {\n\t\t'notebook': nb['name'],\n\t\t'notebook_uuid': nb['uuid']\n\t}\n\tmeta = json.loads(editor.get_file_contents(os.path.join(notedir, 'meta.json'), root))\n\tcontent = json.loads(editor.get_file_contents(os.path.join(notedir, 'content.json'), root))\n\tmd = quiverlib.quiver2md(content, meta, note, 'resources')\n\tfname = '\/'+meta['uuid']+'.md'\n\tok = editor.set_file_contents(fname, md, 'local')\n\ttry:\n\t\tos.mkdir(local+'\/resources')\n\texcept:\n\t\tpass\n\tfor f in os.listdir((dbox if root == 'dropbox' else local) + notedir + '\/resources'):\n\t\tx = editor.get_file_contents(os.path.join(notedir, 'resources', f), root)\n\t\tok = ok and editor.set_file_contents(os.path.join('\/resources', f), x, 'local')\n\tif ok:\n\t\tworkflow.set_output(fname)\n\t\tconsole.hud_alert('Quiver pull OK', 'success')\n\telse:\n\t\tconsole.hud_alert('Quiver pull failed', 'error')\nexcept Exception as e:\n\tprint e\n\tconsole.hud_alert('Not in a Quiver note', 'error')\n"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionCondition","parameters":{"comparisonType":1,"expression2":{"type":"advancedText","tokenRanges":{},"text":""},"expression1":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionOpenDocument","parameters":{"filename":"%var:Input","inDropbox":false}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionConditionEnd","parameters":{}}]}