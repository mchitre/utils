{"actions":[{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport json, os\nimport editor, workflow, console\nimport quiverlib\n\nquiverRoot = '\/Quiver.qvlibrary'\ndbox = '\/var\/mobile\/Containers\/Data\/Application\/CC178706-BBCC-4E01-87EE-71BC9E9768C3\/Library\/Application Support\/Dropbox'\n\ndef dropbox_mkdir(d):\n\ttry:\n\t\tos.mkdir(dbox+'\/'+d)\n\texcept:\n\t\tpass\n\nmd = editor.get_text()\nfolder, meta, content, resources = quiverlib.md2quiver(md)\ndropbox_mkdir(os.path.join(quiverRoot, folder))\nfname = os.path.join(quiverRoot, folder, 'meta.json')\nok = editor.set_file_contents(fname, json.dumps(meta, indent=2), 'dropbox')\nfname = os.path.join(quiverRoot, folder, 'content.json')\nok = ok and editor.set_file_contents(fname, json.dumps(content, indent=2), 'dropbox')\nif len(resources) > 0:\n\trdir = os.path.join(quiverRoot, folder, 'resources')\n\tdropbox_mkdir(rdir)\n\tfor r in resources:\n\t\tx = editor.get_file_contents(os.path.join('resources', r), 'local')\n\t\tok = ok and editor.set_file_contents(os.path.join(rdir, r), x, 'dropbox')\n\nif ok:\n\tconsole.hud_alert('Pushed note to Quiver', 'success')\nelse:\n\tconsole.hud_alert('Push to Quiver failed', 'error')\n"}}]}